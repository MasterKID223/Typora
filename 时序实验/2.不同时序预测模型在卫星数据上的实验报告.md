### 实验目的

分别使用DLinear，PatchTST，LSTM，GRU，SVR模型，对TG01数据进行预测，对比各个模型的预测结果。

### 实验环境

6004服务器，CPU。

### 1. 实验细节

#### 1.1. 数据集处理

数据集使用TG时序数据组合体文件夹下的tg01_tbl_rtdata_2.xlsx文件，该文件有118084条数据，每条数据22个维度。时间范围是2012/6/20 00:01:52到2012/6/21 00:00:00，时间不是完全连续的，有时间断点。每条记录是毫秒级，但是一秒内包含的记录数不一样。在这次实验中，只取了每秒的第一条数据，处理过后一共有59092条数据，每条数据22个维度。最后以6:2:2的比例划分为训练集、验证集和测试集。

数据集具体划分如下：训练集（训练集总长度，336，22）、验证集（验证集总长度，336，22）、测试集（测试集总长度，336，22）。标签序列类似，是（每个数据集长度，96，22）。读取数据的时候，每次返回一个batch的数据，即（B，336，22）和（B，96，22）。

#### 1.2. 模型设置

输入的序列长度是336，输出预测长度是96，学习率是0.0001，batch_size是128，优化器是Adam，训练epochs是500。

- DLinear

  数据送入模型之后，先进行成分分解，用移动平均的方法，分成把时序序列分成两个分量，让得到的两个分量分别通过两个全连接层输出预测结果。

- PatchTST

  encoder层数是3，头数是4，patch长度是16，stride是8，patch嵌入的长度是16，FFN隐层维度是128。

- LSTM

  层数是3，隐层维度是512。

- GRU

  层数是3，隐层维度是512。

- SVR

  数据一共有22个维度，每个维度都训练了一个SVR。

  SVR和上面的4种方法划分数据集的方法不同，训练的时候一次把所有数据送给SVR，即（训练集总长度，336）和（训练集总长度，96）。没有采用验证集。为了测试过程中，模拟了batch读取数据的方法，即（B，336）和（B，96）。

  

#### 1.3. 实验结果

|          | MSE       | MAE   |
| -------- | --------- | ----- |
| DLinear  | 11820.181 | 0.746 |
| PatchTST | 11796.279 | 0.741 |
| LSTM     | 11625.426 | 0.641 |
| GRU      | 11625.387 | 0.606 |
| SVR      | 11499.753 | -     |

