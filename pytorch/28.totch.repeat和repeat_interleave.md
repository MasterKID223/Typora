### repeat和repeat_interleave

参考：[[知乎](https://zhuanlan.zhihu.com/p/474153365)]

- repeat

  使张量沿着某个维度进行复制, 并且不仅可以复制张量，也可以拓展张量的维度:

- torch.repeat_interleave

  `torch.repeat_interleave`的行为与`numpy.repeat`类似，但是和`torch.repeat`不同，这边还是以代码为例:

  ```python
  import torch
  x = torch.randn(2, 2)
  
  print(x)
  >>> tensor([[ 0.4332,  0.1172],
              [ 0.8808, -1.7127]])
  
  print(x.repeat(2, 1))
  >>> tensor([[ 0.4332,  0.1172],
              [ 0.8808, -1.7127],
              [ 0.4332,  0.1172],
              [ 0.8808, -1.7127]])
  
  print(x.repeat_interleave(2, dim=0))
  >>> tensor([[ 0.4332,  0.1172],
              [ 0.4332,  0.1172],
              [ 0.8808, -1.7127],
              [ 0.8808, -1.7127]])
  
  print(x.repeat_interleave(2, dim=1))
  >>> tensor([[ 0.4332,  0.4332,  0.1172,  0.1172],
              [ 0.8808,  0.8808, -1.7127, -1.7127]])
  
  # 如果不传dim参数, 则默认复制后拉平
  print(x.repeat_interleave(2))
  >>> tensor([ 0.4332,  0.4332,  0.1172,  0.1172,  0.8808,  0.8808, -1.7127, -1.7127])
  ```

  从这个代码可以看出来`torch.repeat`更像是把tensor作为一个整体进行复制, 而`torch.repeat_interleave`更是针对tensor里的每个元素进行复制，并且`torch.repeat_interleave`可以通过传入一个一维的`torch.Tensor`来指定每个元素复制的次数

  ```python
  import torch
  x = torch.tensor([[1, 2], [3, 4]])
  
  result = torch.repeat_interleave(x, torch.tensor([1, 3]), dim=0)  # 第一个向量重复1次，第二个重复3次
  print(result)
  >>> tensor([[1, 2],
              [3, 4],
              [3, 4],
              [3, 4]])
  ```

