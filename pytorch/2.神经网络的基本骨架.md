## torch.nn.Module

```
官方文档: https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module
```

1. `nn.function.Conv2d方法`

   > ![image-20220705024505584](.pic\image-20220705024505584.png)
   >
   > ![image-20220705031244518](F:\Typora\pytorch\2.神经网络的基本骨架.assets\image-20220705031244518.png)

   

2. `卷积层nn.Conv2d`

> ![image-20220705024939884](F:\Typora\pytorch\2.神经网络的基本骨架.assets\image-20220705024939884.png)
>
> ![image-20220705025017710](F:\Typora\pytorch\2.神经网络的基本骨架.assets\image-20220705025017710.png)

3. `简单实现`

   ```python
   from torch.utils.tensorboard import SummaryWriter
   from torch import nn
   from torch.utils.data import DataLoader
   import torchvision
   import torch
   
   class Lzh(nn.Module):
       def __init__(self) -> None:
           super().__init__()
           # 网络中含有一个卷积层
           self.conv1 = nn.Conv2d(in_channels=3, out_channels=6, kernel_size=3, stride=1, padding=0)
   
       def forward(self, x):
           x = self.conv1(x)
           return x
   
   lzh = Lzh()
   writer = SummaryWriter("logs")
   dataset = torchvision.datasets.CIFAR10("./cifar10", train=False, transform=torchvision.transforms.ToTensor(),
                            download=False)
   data_loader = DataLoader(dataset, batch_size=64)
   
   step = 0
   for data in data_loader:
       imgs, targets = data
       output = lzh(imgs)
       print(imgs.shape)
       print(output.shape)
       writer.add_images("input", imgs, step)
       output = torch.reshape(output, (-1, 3, 30, 30))
       writer.add_images("output", output, step)
       step = step + 1
   
   writer.close()
   ```

   - `结果`

     > ![image-20220705031136877](F:\Typora\pytorch\2.神经网络的基本骨架.assets\image-20220705031136877.png)
     >
     > ![image-20220705031154931](F:\Typora\pytorch\2.神经网络的基本骨架.assets\image-20220705031154931.png)

