### 一对一查询

一对一查询使用如下注解实现：

` @Result(column = "id", property = "articleDetail", one = @One(select = "com.example.mybatis.mapper.ArticleOneToOneMapper.queryContent", fetchType = FetchType.LAZY))})`

其中，`one`属性表示一对一查询，`@One`使用select选项，`properties`指定的对象接收`queryContent`方法返回的对象。

`fetchType = FetchType.LAZY`表示懒加载，在查询这个对象的时候才执行查询，优化效率。

```java
public interface ArticleOneToOneMapper {

    @Select("select * from article_detail where article_id=#{articleId}")
    @Results({
        @Result(id = true, column = "id", property = "id"),
        @Result(column = "article_id", property = "userId"),
        @Result(column = "content", property = "content")
    })
    ArticleDetail queryContent(Integer articleId);

    @Select("select id,user_id,title,summary,read_count,create_time,update_time from article where id=#{id}")
    @Results({
        @Result(id = true, column = "id", property = "id"),
        @Result(column = "user_id", property = "userId"),
        @Result(column = "read_count", property = "readCount"),
        @Result(column = "create_time", property = "createTime"),
        @Result(column = "update_time", property = "updateTime"),
        @Result(column = "id", property = "articleDetail",
            one = @One(select = "com.example.mybatis.mapper.ArticleOneToOneMapper.queryContent", fetchType = FetchType.LAZY))
    })
    Article queryAllArticle(Integer id);
}
```

### 一对多查询

获取一个文章的多个评论。

```java
public interface ArticleOneToManyMapper {

    @Select("select id,article_id,content from comment where article_id=#{articleId} order by id")
    @Results(id = "CommentMapper", value = {
        @Result(id = true, column = "id", property = "id"),
        @Result(column = "article_id", property = "articleId"),
        @Result(column = "content", property = "content")
    })
    List<CommentPO> queryComments(Integer articleId);
//    CommentPO queryComments(Integer articleId);

    @Select("select id,user_id,title,summary,read_count,create_time,update_time from article where id=#{id}")
    @Results(id = "",  value = {
        @Result(id = true, column = "id", property = "id"),
        @Result(column = "user_id", property = "userId"),
        @Result(column = "read_count", property = "readCount"),
        @Result(column = "create_time", property = "createTime"),
        @Result(column = "update_time", property = "updateTime"),
        @Result(column = "id", property = "comments", many = @Many(select = "com.example.mybatis.mapper.ArticleOneToManyMapper.queryComments", fetchType = FetchType.LAZY))
    })
    ArticleEntity queryArticleAndComments(Integer id);
}
```

评论类：

```java
@Data
public class ArticleEntity {
    private Integer id;
    private Integer userId;
    private String title;
    private String summary;
    private Integer readCount;
    private LocalDateTime createTime;
    private LocalDateTime updateTime;
    private List<CommentPO> comments;  // 评论的集合
}
```

使用：

```java
@Autowired
private ArticleOneToManyMapper articleOneToManyMapper;
@Test
void test09() {
    List<CommentPO> commentPOList = articleOneToManyMapper.queryComments(1);
    commentPOList.forEach(comment -> {
        System.out.println("每篇文章的评论是 " + comment);
    });
    ArticleEntity articleEntity = articleOneToManyMapper.queryArticleAndComments(1);
    System.out.println(articleEntity);
}
```

